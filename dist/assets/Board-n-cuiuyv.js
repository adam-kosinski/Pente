import{d as L,a as f,F as g,i as k,o as b,b as _,n as C,_ as N,c as w,g as G,q as O,t as x,f as P,p as $,h as A}from"./index-CmKqbHi7.js";const U="/Pente/leather-texture.jpg";function V(e){const t={board:[],currentPlayer:0,captures:{0:0,1:0},nMoves:0,prevMoves:[],isOver:!1,linearShapes:[]};for(let r=0;r<e;r++)t.board.push({});return t}function ne(e){return e.board.length+"~"+e.prevMoves.map(t=>t.addedGems[0].join(".")).join("|")}function oe(e){const[t,r]=e.split("~"),c=r.split("|").map(d=>d.split(".").map(a=>Number(a))),o=V(Number(t));for(const[d,a]of c)z(o,d,a);return o}function z(e,t,r){if(t<0||t>=e.board.length||r<0||r>=e.board.length||e.board[t][r]!==void 0)return;const c=Math.floor(e.board.length/2),o=Math.floor(e.board.length/2);if(e.nMoves===0&&(t!==c||r!==o))return;const d={added:[],removed:[]},a={addedGems:[],removedGems:[],linearShapeUpdate:d};e.board[t][r]=e.currentPlayer,a.addedGems.push([t,r]);for(let s of[-1,0,1])for(let l of[-1,0,1])s===0&&l===0||r+3*s<0||r+3*s>=e.board.length||t+3*l<0||t+3*l>=e.board.length||e.board[t+l][r+s]!==void 0&&e.board[t+l][r+s]!==e.currentPlayer&&e.board[t+l][r+s]===e.board[t+2*l][r+2*s]&&e.board[t+3*l][r+3*s]===e.currentPlayer&&(delete e.board[t+l][r+s],delete e.board[t+2*l][r+2*s],a.removedGems.push([t+l,r+s],[t+2*l,r+2*s]),e.captures[e.currentPlayer]++);a.addedGems.concat(a.removedGems).forEach(([s,l])=>{H(e,s,l,d)}),(e.captures[0]>=5||e.captures[1]>=5||e.linearShapes.some(s=>s.type==="pente"))&&(e.isOver=!0),e.prevMoves.push(a),e.currentPlayer=+!e.currentPlayer,e.nMoves++}function se(e){const t=e.prevMoves.pop();if(!t)return;const r=+!e.currentPlayer;t.addedGems.forEach(([o,d])=>{delete e.board[o][d]}),e.captures[r]-=t.removedGems.length/2,t.removedGems.forEach(([o,d])=>{e.board[o][d]=e.currentPlayer});const c=t.linearShapeUpdate.added.map(o=>o.hash);e.linearShapes=e.linearShapes.filter(o=>!c.includes(o.hash)),t.linearShapeUpdate.removed.forEach(o=>e.linearShapes.push(o)),e.currentPlayer=r,e.nMoves-=1,e.isOver=!1}const F={pente:"11111","open-tessera":"_1111_","pente-threat-4":"1111_","pente-threat-31":"111_1","pente-threat-22":"11_11","open-tria":"_111_","stretch-tria":"_11_1_","extendable-tria":"111__","extendable-stretch-tria-1":"1_11_","extendable-stretch-tria-2":"11_1_","open-pair":"_11_","capture-threat":"100_","stretch-two":"_1_1_","double-stretch-two":"_1__1_","three-gap":"1___1","pente-potential-1":"1_1_1","pente-potential-2":"1__11"},y=new Map;let M=0;for(const[e,t]of Object.entries(F)){y.set(t,{type:e,owner:1,length:t.length}),y.set(t.split("").reverse().join(""),{type:e,owner:1,length:t.length});const r=t.replace(/1/g,"x").replace(/0/g,"1").replace(/x/g,"0");y.set(r,{type:e,owner:0,length:t.length}),y.set(r.split("").reverse().join(""),{type:e,owner:0,length:t.length}),M=Math.max(t.length,M)}const I=new Map;function D(e){const t=I.get(e);if(t)return t;const r=[];for(const c of y.keys())for(let o=0;o<=e.length-c.length;o++){let d=!0;for(let a=0;a<c.length;a++)if(e[o+a]!==c[a]){d=!1;break}d&&r.push({index:o,pattern:c})}return I.set(e,r),r}function H(e,t,r,c={added:[],removed:[]}){e.linearShapes=e.linearShapes.filter(a=>{const s=a.dy,l=a.dx;if(s===0&&t!==a.begin[0]||l===0&&r!==a.begin[1])return!0;for(let h=0,n=a.begin[0],p=a.begin[1];h<a.length;h++,n+=s,p+=l)if((e.board[n][p]===void 0?"_":e.board[n][p].toString())!==a.pattern.charAt(h))return c.removed.push(a),!1;return!0});const o=e.board[t][r],d=o===void 0?"_":o.toString();for(const[a,s]of[[0,1],[1,0],[1,1],[-1,1]]){let l=d,h=t-a,n=r-s;for(let i=1;i<M&&!(h<0||n<0||h>=e.board.length||n>=e.board.length);i++,h-=a,n-=s){const u=e.board[h][n];l=(u===void 0?"_":u)+l}h+=a,n+=s;for(let i=1,u=t+a,v=r+s;i<M&&!(u<0||v<0||u>=e.board.length||v>=e.board.length);i++,u+=a,v+=s){const m=e.board[u][v];l+=m===void 0?"_":m}const p=D(l);if(p)for(const i of p){const u=i.pattern,v=y.get(u),m=[h+a*i.index,n+s*i.index],S={type:v.type,pattern:u,owner:v.owner,begin:m,dy:a,dx:s,length:v.length,hash:[v.type,v.owner,m,a,s].join()};e.linearShapes.some(E=>E.hash===S.hash)||(e.linearShapes.push(S),c.added.push(S))}}}const T={class:"captures-area"},q=["data-player"],J=["data-player"],K=L({__name:"CapturesArea",props:{nCaptures:{},gemPlayer:{}},setup(e){return(t,r)=>(b(),f("div",T,[(b(),f(g,null,k(5,c=>_("div",null,[_("div",{class:C(["pair-container",{visible:c<=t.nCaptures}])},[_("div",{class:"gem","data-player":t.gemPlayer},null,8,q),_("div",{class:"gem","data-player":t.gemPlayer},null,8,J)],2)])),64))]))}}),B=N(K,[["__scopeId","data-v-18a16851"]]),j=e=>($("data-v-bb196b75"),e=e(),A(),e),Q={class:"board-element"},R=j(()=>_("img",{class:"board-background",src:U},null,-1)),W=["onClick"],X={key:0,class:"row-label"},Y={key:1,class:"col-label"},Z=["data-player"],ee=["data-player"],te=j(()=>_("div",{class:"grid-line-box"},null,-1)),re=L({__name:"Board",props:{game:{},showCoordLabels:{type:Boolean},disabled:{type:Boolean}},emits:["make-move"],setup(e,{emit:t}){O(n=>({"10c84fbd":o.value+3,ece5b442:o.value,"2b27d63b":n.disabled?"default":"pointer"}));const r=e,c=t,o=w(()=>r.game.board.length),d=w(()=>Math.floor(o.value/2)),a=w(()=>{var n;return(n=r.game.prevMoves.slice(-1)[0])==null?void 0:n.addedGems[0]});function s(n,p){return n===d.value&&p===d.value||Math.abs(n-d.value)===3&&Math.abs(p-d.value)===3}function l(n,p){return!(r.game.isOver||r.game.board[n][p]!==void 0||r.game.nMoves===0&&(n!==d.value||p!==d.value))}function h(n,p){r.disabled||l(n,p)&&c("make-move",n,p)}return(n,p)=>(b(),f("div",Q,[R,(b(!0),f(g,null,k(o.value,i=>(b(),f(g,null,[(b(!0),f(g,null,k(o.value,u=>(b(),f("div",{class:C(["intersection",{significant:s(i-1,u-1),"last-col":u===o.value,"last-row":i===o.value,"legal-move":l(i-1,u-1)}]),onClick:v=>h(i-1,u-1)},[u===1&&n.showCoordLabels?(b(),f("p",X,x(i-1),1)):P("",!0),i===o.value&&n.showCoordLabels?(b(),f("p",Y,x(u-1),1)):P("",!0),n.game.board[i-1][u-1]!==void 0?(b(),f("div",{key:2,class:C(["real gem",{"last-move":i-1===a.value[0]&&u-1===a.value[1]}]),"data-player":n.game.board[i-1][u-1]},null,10,Z)):n.disabled?P("",!0):(b(),f("div",{key:3,class:"ghost gem","data-player":n.game.currentPlayer},null,8,ee)),te],10,W))),256))],64))),256)),G(B,{class:"captures top","n-captures":n.game.captures[1],gemPlayer:0},null,8,["n-captures"]),G(B,{class:"captures bottom","n-captures":n.game.captures[0],gemPlayer:1},null,8,["n-captures"])]))}}),le=N(re,[["__scopeId","data-v-bb196b75"]]);export{le as B,F as a,V as c,ne as g,oe as l,z as m,se as u};
